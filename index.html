<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>üß™ TEST SHEET.BEST - Gestion compl√®te</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        * { margin:0; padding:0; box-sizing:border-box; font-family: 'Segoe UI', sans-serif; }
        body {
            background: linear-gradient(135deg, #0b2f2f 0%, #1a4a4a 100%);
            color: white;
            padding: 20px;
        }
        h1 { color: #ffb347; margin-bottom: 20px; }
        .container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
        }
        .card {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(5px);
            border-left: 5px solid #ffb347;
        }
        .card h2 { color: #ffb347; margin-bottom: 15px; }
        input, select, textarea {
            width: 100%;
            padding: 10px;
            margin: 8px 0;
            border: 2px solid #ddd;
            border-radius: 10px;
        }
        button {
            background: #ffb347;
            color: #0b2f2f;
            border: none;
            padding: 10px 20px;
            border-radius: 30px;
            font-weight: bold;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #0b2f2f; color: #ffb347; }
        .data-list {
            margin-top: 15px;
            max-height: 200px;
            overflow-y: auto;
        }
        .item {
            background: rgba(0,0,0,0.3);
            padding: 8px;
            margin: 5px 0;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .delete-btn {
            background: #ff4444;
            color: white;
            border: none;
            padding: 5px 15px;
            border-radius: 20px;
            cursor: pointer;
        }
        .resultat {
            background: rgba(0,0,0,0.3);
            padding: 10px;
            border-radius: 10px;
            margin-top: 20px;
            font-family: monospace;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <h1>üìã GESTION DES DONN√âES SHEET.BEST</h1>
    <p>URL : <code>https://api.sheetbest.com/sheets/70923d86-6d1a-4756-bf21-a869acf3e029</code></p>

    <div class="container">
        <!-- Carte √âL√àVES -->
        <div class="card">
            <h2>üë®‚Äçüéì √âl√®ves</h2>
            <input type="text" id="eleveNom" placeholder="Nom">
            <input type="text" id="elevePrenom" placeholder="Pr√©nom">
            <input type="text" id="eleveClasse" placeholder="Classe">
            <button onclick="ajouter('eleves', {nom: get('eleveNom'), prenom: get('elevePrenom'), classe: get('eleveClasse')})">‚ûï Ajouter √©l√®ve</button>
            <button onclick="voir('eleves')">üìã Voir liste</button>
            <div id="liste-eleves" class="data-list"></div>
        </div>

        <!-- Carte PUBLICATIONS -->
        <div class="card">
            <h2>üì∞ Publications</h2>
            <input type="text" id="pubTitre" placeholder="Titre">
            <textarea id="pubContenu" placeholder="Contenu" rows="3"></textarea>
            <button onclick="ajouter('publications', {titre: get('pubTitre'), contenu: get('pubContenu')})">‚ûï Ajouter publication</button>
            <button onclick="voir('publications')">üìã Voir liste</button>
            <div id="liste-publications" class="data-list"></div>
        </div>

        <!-- Carte COURS -->
        <div class="card">
            <h2>üìö Cours</h2>
            <input type="text" id="coursTitre" placeholder="Titre">
            <input type="text" id="coursProf" placeholder="Professeur">
            <textarea id="coursDesc" placeholder="Description" rows="2"></textarea>
            <select id="coursType">
                <option value="video">Vid√©o</option>
                <option value="pdf">PDF</option>
            </select>
            <input type="text" id="coursLien" placeholder="Lien">
            <button onclick="ajouter('cours', {titre: get('coursTitre'), professeur: get('coursProf'), description: get('coursDesc'), type: get('coursType'), lien: get('coursLien')})">‚ûï Ajouter cours</button>
            <button onclick="voir('cours')">üìã Voir liste</button>
            <div id="liste-cours" class="data-list"></div>
        </div>

        <!-- Carte CLASSES -->
        <div class="card">
            <h2>üè´ Classes</h2>
            <input type="text" id="classeNom" placeholder="Nom de la classe">
            <button onclick="ajouter('classes', {nom: get('classeNom')})">‚ûï Ajouter classe</button>
            <button onclick="voir('classes')">üìã Voir liste</button>
            <div id="liste-classes" class="data-list"></div>
        </div>

        <!-- Carte ADMINISTRATION -->
        <div class="card">
            <h2>üë®‚Äçüè´ Administration</h2>
            <input type="text" id="adminNom" placeholder="Nom">
            <input type="text" id="adminRole" placeholder="R√¥le">
            <button onclick="ajouter('administration', {nom: get('adminNom'), role: get('adminRole')})">‚ûï Ajouter membre</button>
            <button onclick="voir('administration')">üìã Voir liste</button>
            <div id="liste-administration" class="data-list"></div>
        </div>

        <!-- Carte ANCIENS -->
        <div class="card">
            <h2>üéì Anciens √©l√®ves</h2>
            <input type="text" id="ancienNom" placeholder="Nom">
            <input type="text" id="ancienAnnee" placeholder="Ann√©e du Bac">
            <input type="text" id="ancienParcours" placeholder="Parcours">
            <button onclick="ajouter('anciens', {nom: get('ancienNom'), annee: get('ancienAnnee'), parcours: get('ancienParcours')})">‚ûï Ajouter ancien</button>
            <button onclick="voir('anciens')">üìã Voir liste</button>
            <div id="liste-anciens" class="data-list"></div>
        </div>
    </div>

    <div class="resultat" id="resultat">
        üëÜ Clique sur un bouton pour commencer...
    </div>

    <script>
    const BASE_URL = 'https://api.sheetbest.com/sheets/70923d86-6d1a-4756-bf21-a869acf3e029';

    // Helper pour r√©cup√©rer la valeur d'un input
    function get(id) {
        return document.getElementById(id).value.trim();
    }

    // Helper pour afficher les r√©sultats
    function afficher(message, type = 'info') {
        const div = document.getElementById('resultat');
        div.innerHTML = message;
        div.style.borderLeftColor = type === 'success' ? '#4CAF50' : (type === 'error' ? '#ff4444' : '#ffb347');
    }

    // ============================================
    // FONCTIONS PRINCIPALES
    // ============================================

    // VOIR les donn√©es d'un onglet
    async function voir(onglet) {
        afficher(`‚è≥ Chargement de "${onglet}"...`);
        try {
            const url = `${BASE_URL}#${onglet}`;
            const res = await fetch(url);
            const data = await res.json();
            
            // Affiche dans la zone de r√©sultat
            afficher(
                `‚úÖ ${data.length} √©l√©ment(s) dans "${onglet}"\n\n` +
                JSON.stringify(data, null, 2),
                'success'
            );
            
            // Met √† jour la liste visuelle
            const listeDiv = document.getElementById(`liste-${onglet}`);
            if (listeDiv) {
                if (data.length === 0) {
                    listeDiv.innerHTML = '<p>Aucune donn√©e</p>';
                } else {
                    let html = '';
                    data.forEach((item, index) => {
                        const ligneId = index + 1;
                        html += `
                            <div class="item">
                                <span>${JSON.stringify(item).substring(0, 50)}...</span>
                                <button class="delete-btn" onclick="supprimer('${onglet}', ${ligneId})">üóëÔ∏è</button>
                            </div>
                        `;
                    });
                    listeDiv.innerHTML = html;
                }
            }
        } catch (err) {
            afficher(`‚ùå Erreur : ${err.message}`, 'error');
        }
    }

    // AJOUTER des donn√©es
    async function ajouter(onglet, donnees) {
        // V√©rifie que les champs ne sont pas vides
        for (let [key, value] of Object.entries(donnees)) {
            if (!value) {
                afficher(`‚ùå Le champ "${key}" est requis`, 'error');
                return;
            }
        }

        afficher(`‚è≥ Ajout dans "${onglet}"...`);
        
        try {
            const url = `${BASE_URL}#${onglet}`;
            const res = await fetch(url, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify([donnees])
            });
            
            if (res.ok) {
                afficher(`‚úÖ Ajout r√©ussi dans "${onglet}" !`, 'success');
                // Vide les champs
                for (let key in donnees) {
                    const inputId = key === 'titre' ? 'pubTitre' :
                                   key === 'contenu' ? 'pubContenu' :
                                   key === 'professeur' ? 'coursProf' :
                                   key === 'description' ? 'coursDesc' :
                                   key === 'type' ? 'coursType' :
                                   key === 'lien' ? 'coursLien' :
                                   key === 'annee' ? 'ancienAnnee' :
                                   key === 'parcours' ? 'ancienParcours' :
                                   `${onglet}${key.charAt(0).toUpperCase() + key.slice(1)}`;
                    const input = document.getElementById(inputId);
                    if (input) input.value = '';
                }
                // Recharge la liste
                voir(onglet);
            } else {
                afficher(`‚ùå Erreur lors de l'ajout`, 'error');
            }
        } catch (err) {
            afficher(`‚ùå Erreur : ${err.message}`, 'error');
        }
    }

    // SUPPRIMER des donn√©es
    async function supprimer(onglet, ligneId) {
        if (!confirm(`Supprimer la ligne ${ligneId} de "${onglet}" ?`)) return;
        
        try {
            const url = `${BASE_URL}#${onglet}/${ligneId}`;
            const res = await fetch(url, { method: 'DELETE' });
            
            if (res.ok) {
                afficher(`‚úÖ Ligne ${ligneId} supprim√©e de "${onglet}"`, 'success');
                voir(onglet); // Recharge la liste
            } else {
                afficher(`‚ùå Erreur lors de la suppression`, 'error');
            }
        } catch (err) {
            afficher(`‚ùå Erreur : ${err.message}`, 'error');
        }
    }

    // Initialisation : charge quelques donn√©es au d√©marrage
    window.onload = async function() {
        afficher('‚úÖ Connect√© √† Sheet.best !\nClique sur "Voir liste" pour chaque cat√©gorie.');
    };
    </script>
</body>
        </html>

