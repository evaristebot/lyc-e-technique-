<!DOCTYPE html>
<html>
<head>
    <title>âœ… TEST ULTIME SHEET.BEST</title>
</head>
<body>
    <h1>ğŸ” Test avec la bonne syntaxe</h1>
    
    <div>
        <button onclick="test('eleves')">ğŸ“‹ Ã‰lÃ¨ves</button>
        <button onclick="test('publications')">ğŸ“° Publications</button>
        <button onclick="test('cours')">ğŸ“š Cours</button>
        <button onclick="test('classes')">ğŸ« Classes</button>
        <button onclick="test('administration')">ğŸ‘¨â€ğŸ« Administration</button>
        <button onclick="test('anciens')">ğŸ“ Anciens</button>
    </div>

    <div style="margin-top:20px;">
        <h3>Ajouter un test</h3>
        <button onclick="ajouterTest('publications')">â• Test publications</button>
        <button onclick="ajouterTest('cours')">â• Test cours</button>
        <button onclick="ajouterTest('classes')">â• Test classes</button>
        <button onclick="ajouterTest('administration')">â• Test administration</button>
        <button onclick="ajouterTest('anciens')">â• Test anciens</button>
    </div>

    <pre id="resultat" style="background:#f0f0f0; padding:15px; margin-top:20px; border-radius:5px;"></pre>

    <script>
    const BASE_URL = 'https://api.sheetbest.com/sheets/70923d86-6d1a-4756-bf21-a869acf3e029';

    function afficher(message, type = 'info') {
        const pre = document.getElementById('resultat');
        pre.innerHTML = message;
        pre.style.color = type === 'error' ? 'red' : 'green';
    }

    // TESTER UN ONGLET
    async function test(onglet) {
        afficher(`â³ Test de "${onglet}"...`);
        
        try {
            // LA BONNE SYNTAXE : #nom_onglet
            const url = `${BASE_URL}#${onglet}`;
            console.log('ğŸ“¡ URL:', url);
            
            const res = await fetch(url);
            const data = await res.json();
            
            let message = `âœ… Onglet "${onglet}" trouvÃ© !\n`;
            message += `ğŸ“Š ${data.length} Ã©lÃ©ment(s)\n\n`;
            message += JSON.stringify(data, null, 2);
            
            afficher(message);
            
        } catch (err) {
            afficher(`âŒ Erreur: ${err.message}`, 'error');
        }
    }

    // AJOUTER UN TEST
    async function ajouterTest(onglet) {
        let donnees = {};
        
        switch(onglet) {
            case 'publications':
                donnees = { titre: "Test " + Date.now(), contenu: "Test rÃ©ussi !" };
                break;
            case 'cours':
                donnees = { 
                    titre: "Cours test", 
                    professeur: "Prof Test", 
                    description: "Description", 
                    type: "pdf", 
                    lien: "#" 
                };
                break;
            case 'classes':
                donnees = { nom: "Classe Test" };
                break;
            case 'administration':
                donnees = { nom: "Test Admin", role: "Testeur" };
                break;
            case 'anciens':
                donnees = { nom: "Test Ancien", annee: "2020", parcours: "Testeur" };
                break;
        }
        
        afficher(`â³ Ajout dans "${onglet}"...`);
        
        try {
            const url = `${BASE_URL}#${onglet}`;
            const res = await fetch(url, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify([donnees])
            });
            
            if (res.ok) {
                afficher(`âœ… Test ajoutÃ© dans "${onglet}" !`);
                setTimeout(() => test(onglet), 1000);
            } else {
                const text = await res.text();
                afficher(`âŒ Erreur ${res.status}: ${text}`, 'error');
            }
        } catch (err) {
            afficher(`âŒ Erreur: ${err.message}`, 'error');
        }
    }
    </script>
</body>
</html>

